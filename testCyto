from utils import match_images_and_masks, initializeImages, createDataframe, match_images_and_masks_without_ROI
from plot_functions import plotNeuronsRegions, plotNeuronsRegionsbyRegion, plotRegionNeuronsDensity
from image import Image
import os
import numpy as np
from matplotlib import pyplot as plt
import pandas as pd

image_folder = 'Images'
mask_folder = 'masks'

image_files = match_images_and_masks_without_ROI(image_folder, mask_folder)
objects = initializeImages(image_files)

nucleus_df = pd.DataFrame(columns=['Condition', 'ImageName','Label', 'Area', 'Centroid', 'CellType', 'Location', 'Ch1Intensity', 'Ch2Intensity', 'Ch3Intensity', 'Ch4Intensity', 'CytoCh1Intensity','CytoCh2Intensity','CytoCh3Intensity','CytoCh4Intensity'])
image_df = pd.DataFrame(columns=['Condition','ImageName', 'CA1Volume', 'CA3Volume', 'DGVolume','Ch1Intensity','Ch2Intensity','Ch3Intensity','Ch4Intensity'])

for object in objects:
    print(object.name, len(object.nuclei))
    object.measureCyto()
    object_df = createDataframe(object, condition='Contra')
    nucleus_df = pd.concat([nucleus_df, object_df], ignore_index=True)
    break

nucleus_df.to_csv("dataAnalysisNotebooks/nucleiCyto.csv", index=False)